<div class="page__related">
  <h4 class="page__related-title">{{ site.data.series | where: 'id', page.series | map: 'title' }} Series</h4>
  <div class="grid__wrapper">
    {% assign series-posts = site.posts | reverse | where: 'series', page.series %}
    {% for post in series-posts %}
      {% if post.url == page.url %}
        {% assign prev_post_index = forloop.index | minus: 1 %}
        {% assign curr_post_index = forloop.index %}
        {% assign next_post_index = forloop.index | plus: 1 %}
      {% endif %}
    {% endfor %}

    <p>Post <strong>{{ curr_post_index }}</strong> of <strong>{{ series-posts.size }}</strong>.
      {% if series-posts.size == 1 %}More posts coming soon!{% endif %}</p>

    {% for post in series-posts %}
      {% if prev_post_index == forloop.index %}
        <a class="btn" rel="prev" href="{{ post.url | relative_url }}" rel="permalink">&larr; Prev Post</a>
      {% endif %}

      {% if next_post_index == forloop.index %}
        <a class="btn" rel="next" href="{{ post.url | relative_url }}" rel="permalink">Next Post &rarr;</a>
      {% endif %}
    {% endfor %}
  </div>
</div>